?rpois
install.packages(c("RCurl", "reticulate", "spatstat.explore"))
?MapQuery
library(Seurat)
MapQuery
?MapQuery
?FindMarkers
?IntegrateData
?DimPlot
library(Seurat)
?DimPlot
library(DESeq2)
library(data.table)
library(pheatmap)
set.seed(1234)
##### SETUP #####
base_dir <- "C:/Users/wat2/Documents/GitHub/Influenza/"
source(paste0(base_dir, "bulk_RNA_analysis_helper.R"))
setup_bulk_analysis()
high_placebo_period_2_LRT_metadata <- high_placebo_metadata[high_placebo_metadata$time_point == "2_D28" | high_placebo_metadata$time_point == "2_D8" |
high_placebo_metadata$time_point == "2_D5" | high_placebo_metadata$time_point == "2_D2" |
high_placebo_metadata$time_point == "2_D_minus_1",]
high_placebo_period_2_LRT_metadata <- high_placebo_period_2_LRT_metadata[high_placebo_period_2_LRT_metadata$subject_id
%in% names(table(high_placebo_period_2_LRT_metadata$subject_id)
[table(high_placebo_period_2_LRT_metadata$subject_id) == 5]),]
high_placebo_period_2_LRT_counts <- high_placebo_counts[rownames(high_placebo_period_2_LRT_metadata)]
high_placebo_period_2_LRT_analysis <- DESeqDataSetFromMatrix(countData = high_placebo_period_2_LRT_counts,
colData = high_placebo_period_2_LRT_metadata,
design = ~ subject_id + time_point)
high_placebo_period_2_LRT_analysis <- DESeq(high_placebo_period_2_LRT_analysis, test = "LRT", reduced = ~ subject_id)
high_placebo_period_2_LRT_analysis_results <- results(high_placebo_period_2_LRT_analysis, alpha = 0.05)
high_placebo_period_2_LRT_analysis_results <- high_placebo_period_2_LRT_analysis_results[order(high_placebo_period_2_LRT_analysis_results$padj),]
high_placebo_period_2_LRT_analysis_results <- subset(high_placebo_period_2_LRT_analysis_results, padj < 0.05)
high_placebo_period_2_LRT_analysis_2000_topGenes <- head(order(high_placebo_period_2_LRT_analysis_results_for_plotting$padj),2000)
high_placebo_period_2_LRT_analysis_results
high_placebo_period_2_LRT_analysis_200_topGenes <- head(order(high_placebo_period_2_LRT_analysis_results$padj),2000)
high_placebo_period_2_LRT_analysis_2000_topGenes <- head(order(high_placebo_period_2_LRT_analysis_results$padj),2000)
high_placebo_period_2_LRT_analysis_2000_topGenes
high_placebo_period_2_LRT_analysis_results
high_placebo_period_2_LRT_analysis_2000_topGenes <- rownames(head(order(high_placebo_period_2_LRT_analysis_results$padj),2000))
high_placebo_period_2_LRT_analysis_2000_topGenes
head(order(high_placebo_period_2_LRT_analysis_results$padj)
)
high_placebo_period_2_LRT_analysis_results
rownames(high_placebo_period_2_LRT_analysis_results)
order(high_placebo_period_2_LRT_analysis_results_for_plotting$padj)
order(high_placebo_period_2_LRT_analysis_results$padj)
rownames(high_placebo_period_2_LRT_analysis_results)
rownames(high_placebo_period_2_LRT_analysis_results)[1:2000]
high_placebo_period_2_LRT_analysis_results
high_placebo_period_2_LRT_analysis_results[2000,]
?write.table
write.table(rownames(high_placebo_period_2_LRT_analysis_results)[1:2000], file = paste0(output_dir, "top_2000_genes_LRT.txt"))
write.table(rownames(high_placebo_period_2_LRT_analysis_results)[1:2000], file = paste0(data_dir, "top_2000_genes_LRT.txt"))
?save
