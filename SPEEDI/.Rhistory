?as.sparse
?rowVars
?inherits
?rowVars
library(Seurat)
?rowVars
Seurat::rowVars
import(hdf5r)
library(hdf5r)
?detectCores
?registerDoMC
library(hdf5r)
library(Seurat)
library(SeuratDisk)
library(SeuratData)
library(SeuratWrappers)
library(SingleCellExperiment)
library(plyr)
library(dplyr)
library(magrittr)
library(Matrix)
library(Matrix.utils)
library(ggplot2)
library(zoo)
library(ggfortify)
library(parallel)
library(purrr)
library(R.utils)
library(svMisc)
library(foreach)
library(doMC) # Only available for linux
?registerDoMC
install.packages("doMC", repos="http://R-Forge.R-project.org")
install.packages("doMC")
install.packages("doMC", repos="http://R-Forge.R-project.org")
install.packages("doParallel")
library("doParallel")
?`%dopar%`
?Read10X_h5
vignette("hdf5r")
hdf5r::tempfile
hdf5r::get_cpd_labels
hdf5r::as_hex()
?hist
?quantile
s.genes
cc.genes.updated.2019
Seurat::cc.genes.updated.2019
cc.genes.updated.2019
?compute_lisi
library(hdf5r)
library(Seurat)
library(SeuratDisk)
library(SeuratData)
library(SeuratWrappers)
library(SingleCellExperiment)
library(plyr)
library(dplyr)
library(magrittr)
library(Matrix)
library(Matrix.utils)
library(ggplot2)
library(zoo)
library(ggfortify)
library(parallel)
library(purrr)
library(R.utils)
library(svMisc)
library(foreach)
library(doMC) # Only available for linux
library(doParallel)
library(lisi)
library(outliers)
library(gmodels)
library(reticulate)
library(kBET)
library(irlba)
library(kneedle)
library(scCustomize)
library(scDblFinder)
?compute_lisi
?aggregate
?aggregate
?aggregate
?aggregate
?aggregate
aggregate
?aggregate
?dixon.test
?InstallData
library(RCurl)
?InstallData
?LoadH5Seurat
?data
.libPaths()
install.packages(c("BiocManager", "cachem", "dbplyr", "dtplyr", "fastmap", "Formula", "httr", "igraph", "lava", "RcppNumerical"))
?FindAllMarkers
?FindMarkers
?diff_markers
?FindMarkers
library(DESeq2)
library(data.table)
library(pheatmap)
set.seed(1234)
##### SETUP #####
base_dir <- "C:/Users/wat2/Documents/GitHub/Influenza/"
source(paste0(base_dir, "bulk_RNA_analysis_helper.R"))
setup_bulk_analysis()
high_placebo_period_2_LRT_metadata <- high_placebo_metadata[high_placebo_metadata$time_point == "2_D28" | high_placebo_metadata$time_point == "2_D8" |
high_placebo_metadata$time_point == "2_D5" | high_placebo_metadata$time_point == "2_D2" |
high_placebo_metadata$time_point == "2_D_minus_1",]
high_placebo_period_2_LRT_metadata <- high_placebo_period_2_LRT_metadata[high_placebo_period_2_LRT_metadata$subject_id
%in% names(table(high_placebo_period_2_LRT_metadata$subject_id)
[table(high_placebo_period_2_LRT_metadata$subject_id) == 5]),]
high_placebo_period_2_LRT_counts <- high_placebo_counts[rownames(high_placebo_period_2_LRT_metadata)]
high_placebo_period_2_LRT_analysis <- DESeqDataSetFromMatrix(countData = high_placebo_period_2_LRT_counts,
colData = high_placebo_period_2_LRT_metadata,
design = ~ subject_id + time_point)
high_placebo_period_2_LRT_analysis <- DESeq(high_placebo_period_2_LRT_analysis, test = "LRT", reduced = ~ subject_id)
high_placebo_period_2_LRT_analysis_results <- results(high_placebo_period_2_LRT_analysis, alpha = 0.05)
high_placebo_period_2_LRT_analysis_results <- high_placebo_period_2_LRT_analysis_results[order(high_placebo_period_2_LRT_analysis_results$padj),]
high_placebo_period_2_LRT_analysis_results <- subset(high_placebo_period_2_LRT_analysis_results, padj < 0.05)
high_placebo_period_2_LRT_analysis_results
marker_dir <- "C:/Users/wat2/Desktop/02-28/DEGs/Unfiltered"
output_dir <- "C:/Users/wat2/Desktop/02-28/DEGs/Unfiltered/UPDATED/"
marker_files <- list.files(marker_dir, pattern = "*.csv$", full.names = TRUE)
marker_file <- marker_files[1]
marker_file
marker_file_content <- read.table(marker_file)
marker_file_content
marker_file_content <- read.table(marker_file, sep = ",")
marker_file_content
marker_file_content <- read.table(marker_file, sep = ",", header = TRUE)
marker_file_content
marker_file_content$p_val_adj <- p.adjust(marker_file_content$p_val, method='fdr')
marker_file_content
?p.adjust
marker_file_content$p_val_adj <- p.adjust(marker_file_content$p_val, method='bonferroni')
marker_file_content
marker_file_content$p_val_adj <- p.adjust(marker_file_content$p_val, method='fdr')
marker_file_content
marker_file_content <- read.table(marker_file, sep = ",", header = TRUE)
nrow(marker_file_content[marker_file_content$p_val_adj < 0.05,])
marker_file_content$p_val_adj <- p.adjust(marker_file_content$p_val, method='fdr')
nrow(marker_file_content[marker_file_content$p_val_adj < 0.05,])
marker_dir <- "C:/Users/wat2/Desktop/02-28/DEGs/Unfiltered"
output_dir <- "C:/Users/wat2/Desktop/02marker_dir <- "C:/Users/wat2/Desktop/02-28/DEGs/Unfiltered"
output_dir <- "C:/Users/wat2/Desktop/02-28/DEGs/Unfiltered/UPDATED/"
marker_files <- list.files(marker_dir, pattern = "*.csv$", full.names = TRUE)
for(marker_file in marker_files) {
marker_file_content <- read.table(marker_file, sep = ",", header = TRUE)
marker_file_content$p_val_adj <- p.adjust(marker_file_content$p_val, method='fdr')
positive_fc_markers <- marker_file_content[marker_file_content$avg_log2FC > 0,]
negative_fc_markers <- marker_file_content[marker_file_content$avg_log2FC < 0,]
write.table(positive_fc_markers, paste0(output_dir, "POS_", basename(marker_file)), quote = FALSE, sep = "\t")
write.table(negative_fc_markers, paste0(output_dir, "NEG_", basename(marker_file)), quote = FALSE, sep = "\t")
}
-28/DEGs/Unfiltered/UPDATED/"
marker_files <- list.files(marker_dir, pattern = "*.csv$", full.names = TRUE)
for(marker_file in marker_files) {
marker_file_content <- read.table(marker_file, sep = ",", header = TRUE)
marker_file_content$p_val_adj <- p.adjust(marker_file_content$p_val, method='fdr')
positive_fc_markers <- marker_file_content[marker_file_content$avg_log2FC > 0,]
negative_fc_markers <- marker_file_content[marker_file_content$avg_log2FC > 0,]
write.table(positive_fc_markers, paste0(output_dir, "POS_", basename(marker_file)), quote = FALSE, sep = "\t")
write.table(negative_fc_markers, paste0(output_dir, "NEG_", basename(marker_file)), quote = FALSE, sep = "\t")
}
marker_dir <- "C:/Users/wat2/Desktop/02-28/DEGs/Unfiltered"
output_dir <- "C:/Users/wat2/Desktop/02-28/DEGs/Unfiltered/UPDATED/"
marker_files <- list.files(marker_dir, pattern = "*.csv$", full.names = TRUE)
for(marker_file in marker_files) {
marker_file_content <- read.table(marker_file, sep = ",", header = TRUE)
marker_file_content$p_val_adj <- p.adjust(marker_file_content$p_val, method='fdr')
positive_fc_markers <- marker_file_content[marker_file_content$avg_log2FC > 0,]
negative_fc_markers <- marker_file_content[marker_file_content$avg_log2FC < 0,]
write.table(positive_fc_markers, paste0(output_dir, "POS_", basename(marker_file)), quote = FALSE, sep = "\t")
write.table(negative_fc_markers, paste0(output_dir, "NEG_", basename(marker_file)), quote = FALSE, sep = "\t")
}
positive_fc_markers
marker_dir <- "C:/Users/wat2/Desktop/02-28/DEGs/Unfiltered"
output_dir <- "C:/Users/wat2/Desktop/02-28/DEGs/Unfiltered/UPDATED/"
marker_files <- list.files(marker_dir, pattern = "*.csv$", full.names = TRUE)
for(marker_file in marker_files) {
marker_file_content <- read.table(marker_file, sep = ",", header = TRUE)
marker_file_content$p_val_adj <- p.adjust(marker_file_content$p_val, method='fdr')
positive_fc_markers <- marker_file_content[marker_file_content$avg_log2FC > 0,]
negative_fc_markers <- marker_file_content[marker_file_content$avg_log2FC < 0,]
write.table(positive_fc_markers, paste0(output_dir, "POS_", basename(marker_file)), quote = FALSE, sep = "\t", header = TRUE)
write.table(negative_fc_markers, paste0(output_dir, "NEG_", basename(marker_file)), quote = FALSE, sep = "\t", header = TRUE)
}
?write.table
marker_dir <- "C:/Users/wat2/Desktop/02-28/DEGs/Unfiltered"
output_dir <- "C:/Users/wat2/Desktop/02-28/DEGs/Unfiltered/UPDATED/"
marker_files <- list.files(marker_dir, pattern = "*.csv$", full.names = TRUE)
for(marker_file in marker_files) {
marker_file_content <- read.table(marker_file, sep = ",", header = TRUE)
marker_file_content$p_val_adj <- p.adjust(marker_file_content$p_val, method='fdr')
positive_fc_markers <- marker_file_content[marker_file_content$avg_log2FC > 0,]
negative_fc_markers <- marker_file_content[marker_file_content$avg_log2FC < 0,]
write.table(positive_fc_markers, paste0(output_dir, "POS_", basename(marker_file)), quote = FALSE, sep = "\t")
write.table(negative_fc_markers, paste0(output_dir, "NEG_", basename(marker_file)), quote = FALSE, sep = "\t")
}
marker_dir <- "C:/Users/wat2/Desktop/02-28/DEGs/Unfiltered"
output_dir <- "C:/Users/wat2/Desktop/02-28/DEGs/Unfiltered/UPDATED/"
marker_files <- list.files(marker_dir, pattern = "*.csv$", full.names = TRUE)
for(marker_file in marker_files) {
marker_file_content <- read.table(marker_file, sep = ",", header = TRUE)
marker_file_content$p_val_adj <- p.adjust(marker_file_content$p_val, method='fdr')
positive_fc_markers <- marker_file_content[marker_file_content$avg_log2FC > 0,]
negative_fc_markers <- marker_file_content[marker_file_content$avg_log2FC < 0,]
write.table(positive_fc_markers, paste0(output_dir, "POS_", basename(marker_file)), quote = FALSE, sep = "\t")
write.table(negative_fc_markers, paste0(output_dir, "NEG_", basename(marker_file)), quote = FALSE, sep = "\t")
}
class(positive_fc_markers)
positive_fc_markers
positive_fc_markers
positive_fc_markers
marker_dir <- "C:/Users/wat2/Desktop/02-28/DEGs/Unfiltered"
output_dir <- "C:/Users/wat2/Desktop/02-28/DEGs/Unfiltered/UPDATED/"
marker_files <- list.files(marker_dir, pattern = "*.csv$", full.names = TRUE)
for(marker_file in marker_files) {
marker_file_content <- read.table(marker_file, sep = ",", header = TRUE)
marker_file_content$p_val_adj <- p.adjust(marker_file_content$p_val, method='fdr')
positive_fc_markers <- marker_file_content[marker_file_content$avg_log2FC > 0,]
negative_fc_markers <- marker_file_content[marker_file_content$avg_log2FC < 0,]
write.table(positive_fc_markers, paste0(output_dir, "POS_", basename(marker_file)), quote = FALSE, sep = "\t")
write.table(negative_fc_markers, paste0(output_dir, "NEG_", basename(marker_file)), quote = FALSE, sep = "\t")
}
marker_dir <- "C:/Users/wat2/Desktop/02-28/DEGs/Unfiltered"
output_dir <- "C:/Users/wat2/Desktop/02-28/DEGs/Unfiltered/UPDATED/"
marker_files <- list.files(marker_dir, pattern = "*.csv$", full.names = TRUE)
for(marker_file in marker_files) {
marker_file_content <- read.table(marker_file, sep = ",", header = TRUE)
marker_file_content$p_val_adj <- p.adjust(marker_file_content$p_val, method='fdr')
positive_fc_markers <- marker_file_content[marker_file_content$avg_log2FC > 0,]
negative_fc_markers <- marker_file_content[marker_file_content$avg_log2FC < 0,]
write.table(positive_fc_markers, paste0(output_dir, "POS_", basename(marker_file)), quote = FALSE, sep = "\t")
write.table(negative_fc_markers, paste0(output_dir, "NEG_", basename(marker_file)), quote = FALSE, sep = "\t")
}
marker_dir <- "C:/Users/wat2/Desktop/02-28/DEGs/Unfiltered"
output_dir <- "C:/Users/wat2/Desktop/02-28/DEGs/Unfiltered/UPDATED/"
marker_files <- list.files(marker_dir, pattern = "*.csv$", full.names = TRUE)
for(marker_file in marker_files) {
marker_file_content <- read.table(marker_file, sep = ",", header = TRUE)
marker_file_content$p_val_adj <- p.adjust(marker_file_content$p_val, method='fdr')
positive_fc_markers <- marker_file_content[marker_file_content$avg_log2FC > 0,]
negative_fc_markers <- marker_file_content[marker_file_content$avg_log2FC < 0,]
write.table(positive_fc_markers, paste0(output_dir, "POS_", basename(marker_file)), quote = FALSE, sep = "\t", row.names = FALSE)
write.table(negative_fc_markers, paste0(output_dir, "NEG_", basename(marker_file)), quote = FALSE, sep = "\t", row.names = FALSE)
}
positive_fc_markers
ncol(positive_fc_markers )
nrow(positive_fc_markers )
marker_dir <- "C:/Users/wat2/Desktop/02-28/DEGs/Unfiltered"
output_dir <- "C:/Users/wat2/Desktop/02-28/DEGs/Unfiltered/UPDATED/"
marker_files <- list.files(marker_dir, pattern = "*.csv$", full.names = TRUE)
for(marker_file in marker_files) {
marker_file_content <- read.table(marker_file, sep = ",", header = TRUE)
marker_file_content$p_val_adj <- p.adjust(marker_file_content$p_val, method='fdr')
positive_fc_markers <- marker_file_content[marker_file_content$avg_log2FC > 0,]
negative_fc_markers <- marker_file_content[marker_file_content$avg_log2FC < 0,]
write.table(positive_fc_markers, paste0(output_dir, "POS_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(negative_fc_markers, paste0(output_dir, "NEG_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
}
?results
marker_dir <- "C:/Users/wat2/Desktop/02-28/DEGs/Unfiltered"
output_dir <- "C:/Users/wat2/Desktop/02-28/DEGs/Unfiltered/UPDATED/"
marker_files <- list.files(marker_dir, pattern = "*.csv$", full.names = TRUE)
for(marker_file in marker_files) {
marker_file_content <- read.table(marker_file, sep = ",", header = TRUE)
marker_file_content$p_val_adj <- p.adjust(marker_file_content$p_val, method='fdr')
positive_fc_markers <- marker_file_content[marker_file_content$avg_log2FC > 0,]
negative_fc_markers <- marker_file_content[marker_file_content$avg_log2FC < 0,]
write.table(positive_fc_markers, paste0(output_dir, "POS_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(negative_fc_markers, paste0(output_dir, "NEG_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
# 0.1, 0.585, 1, 2
positive_fc_markers_0.1 <- positive_fc_markers[positive_fc_markers$avg_log2FC > 0.1,]
positive_fc_markers_0.585 <- positive_fc_markers[positive_fc_markers$avg_log2FC > 0.585,]
positive_fc_markers_1 <- positive_fc_markers[positive_fc_markers$avg_log2FC > 1,]
positive_fc_markers_2 <- positive_fc_markers[positive_fc_markers$avg_log2FC > 2,]
negative_fc_markers_0.1 <- negative_fc_markers[negative_fc_markers$avg_log2FC > 0.1,]
negative_fc_markers_0.585 <- negative_fc_markers[negative_fc_markers$avg_log2FC > 0.585,]
negative_fc_markers_1 <- negative_fc_markers[negative_fc_markers$avg_log2FC > 1,]
negative_fc_markers_2 <- negative_fc_markers[negative_fc_markers$avg_log2FC > 2,]
write.table(positive_fc_markers_0.1, paste0(output_dir, "0.1_POS_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(positive_fc_markers_0.585, paste0(output_dir, "0.585_POS_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(positive_fc_markers_1, paste0(output_dir, "1_POS_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(positive_fc_markers_2, paste0(output_dir, "2_POS_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(negative_fc_markers_0.1, paste0(output_dir, "0.1_NEG_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(negative_fc_markers_0.585, paste0(output_dir, "0.585_NEG_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(negative_fc_markers_1, paste0(output_dir, "1_NEG_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(negative_fc_markers_2, paste0(output_dir, "2_NEG_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
}
marker_dir <- "C:/Users/wat2/Desktop/02-28/DEGs/Unfiltered"
output_dir <- "C:/Users/wat2/Desktop/02-28/DEGs/Unfiltered/UPDATED/"
marker_files <- list.files(marker_dir, pattern = "*.csv$", full.names = TRUE)
for(marker_file in marker_files) {
marker_file_content <- read.table(marker_file, sep = ",", header = TRUE)
marker_file_content$p_val_adj <- p.adjust(marker_file_content$p_val, method='fdr')
positive_fc_markers <- marker_file_content[marker_file_content$avg_log2FC > 0,]
negative_fc_markers <- marker_file_content[marker_file_content$avg_log2FC < 0,]
write.table(positive_fc_markers, paste0(output_dir, "POS_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(negative_fc_markers, paste0(output_dir, "NEG_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
# 0.1, 0.585, 1, 2
positive_fc_markers_0.1 <- positive_fc_markers[positive_fc_markers$avg_log2FC > 0.1,]
positive_fc_markers_0.585 <- positive_fc_markers[positive_fc_markers$avg_log2FC > 0.585,]
positive_fc_markers_1 <- positive_fc_markers[positive_fc_markers$avg_log2FC > 1,]
positive_fc_markers_2 <- positive_fc_markers[positive_fc_markers$avg_log2FC > 2,]
negative_fc_markers_0.1 <- negative_fc_markers[negative_fc_markers$avg_log2FC < 0.1,]
negative_fc_markers_0.585 <- negative_fc_markers[negative_fc_markers$avg_log2FC < 0.585,]
negative_fc_markers_1 <- negative_fc_markers[negative_fc_markers$avg_log2FC < 1,]
negative_fc_markers_2 <- negative_fc_markers[negative_fc_markers$avg_log2FC < 2,]
write.table(positive_fc_markers_0.1, paste0(output_dir, "0.1_POS_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(positive_fc_markers_0.585, paste0(output_dir, "0.585_POS_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(positive_fc_markers_1, paste0(output_dir, "1_POS_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(positive_fc_markers_2, paste0(output_dir, "2_POS_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(negative_fc_markers_0.1, paste0(output_dir, "0.1_NEG_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(negative_fc_markers_0.585, paste0(output_dir, "0.585_NEG_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(negative_fc_markers_1, paste0(output_dir, "1_NEG_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(negative_fc_markers_2, paste0(output_dir, "2_NEG_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
}
marker_file <- marker_files[1]
marker_file
marker_file_content <- read.table(marker_file, sep = ",", header = TRUE)
marker_file_content$p_val_adj <- p.adjust(marker_file_content$p_val, method='fdr')
positive_fc_markers <- marker_file_content[marker_file_content$avg_log2FC > 0,]
negative_fc_markers <- marker_file_content[marker_file_content$avg_log2FC < 0,]
positive_fc_markers_0.1 <- positive_fc_markers[positive_fc_markers$avg_log2FC > 0.1,]
positive_fc_markers_0.1
negative_fc_markers_0.1 <- negative_fc_markers[negative_fc_markers$avg_log2FC < 0.1,]
negative_fc_markers_0.1
nrow(negative_fc_markers_0.1)
nrow(negative_fc_markers)
negative_fc_markers_2 <- negative_fc_markers[negative_fc_markers$avg_log2FC < 2,]
negative_fc_markers_2
nrow(negative_fc_markers_2)
nrow(negative_fc_markers)
# Code to parse DEG markers into positive and negative fold change and change Bonferroni to FDR
marker_dir <- "C:/Users/wat2/Desktop/02-28/DEGs/Unfiltered"
output_dir <- "C:/Users/wat2/Desktop/02-28/DEGs/Unfiltered/UPDATED/"
marker_files <- list.files(marker_dir, pattern = "*.csv$", full.names = TRUE)
for(marker_file in marker_files) {
marker_file_content <- read.table(marker_file, sep = ",", header = TRUE)
marker_file_content$p_val_adj <- p.adjust(marker_file_content$p_val, method='fdr')
positive_fc_markers <- marker_file_content[marker_file_content$avg_log2FC > 0,]
negative_fc_markers <- marker_file_content[marker_file_content$avg_log2FC < 0,]
write.table(positive_fc_markers, paste0(output_dir, "POS_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(negative_fc_markers, paste0(output_dir, "NEG_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
# 0.1, 0.585, 1, 2
positive_fc_markers_0.1 <- positive_fc_markers[positive_fc_markers$avg_log2FC > 0.1,]
positive_fc_markers_0.585 <- positive_fc_markers[positive_fc_markers$avg_log2FC > 0.585,]
positive_fc_markers_1 <- positive_fc_markers[positive_fc_markers$avg_log2FC > 1,]
positive_fc_markers_2 <- positive_fc_markers[positive_fc_markers$avg_log2FC > 2,]
negative_fc_markers_0.1 <- negative_fc_markers[negative_fc_markers$avg_log2FC < -0.1,]
negative_fc_markers_0.585 <- negative_fc_markers[negative_fc_markers$avg_log2FC < -0.585,]
negative_fc_markers_1 <- negative_fc_markers[negative_fc_markers$avg_log2FC < -1,]
negative_fc_markers_2 <- negative_fc_markers[negative_fc_markers$avg_log2FC < -2,]
write.table(positive_fc_markers_0.1, paste0(output_dir, "0.1_POS_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(positive_fc_markers_0.585, paste0(output_dir, "0.585_POS_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(positive_fc_markers_1, paste0(output_dir, "1_POS_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(positive_fc_markers_2, paste0(output_dir, "2_POS_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(negative_fc_markers_0.1, paste0(output_dir, "0.1_NEG_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(negative_fc_markers_0.585, paste0(output_dir, "0.585_NEG_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(negative_fc_markers_1, paste0(output_dir, "1_NEG_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(negative_fc_markers_2, paste0(output_dir, "2_NEG_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
}
Code to parse DEG markers into positive and negative fold change and change Bonferroni to FDR
marker_dir <- "C:/Users/wat2/Desktop/02-28/DEGs/Unfiltered"
output_dir <- "C:/Users/wat2/Desktop/02-28/DEGs/Unfiltered/UPDATED/"
marker_files <- list.files(marker_dir, pattern = "*.csv$", full.names = TRUE)
for(marker_file in marker_files) {
marker_file_content <- read.table(marker_file, sep = ",", header = TRUE)
marker_file_content$p_val_adj <- p.adjust(marker_file_content$p_val, method='fdr')
positive_fc_markers <- marker_file_content[marker_file_content$avg_log2FC > 0,]
negative_fc_markers <- marker_file_content[marker_file_content$avg_log2FC < 0,]
write.table(positive_fc_markers, paste0(output_dir, "UNFILTERED_POS_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(negative_fc_markers, paste0(output_dir, "UNFILTERED_NEG_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
# Should I adjust p value based on only positive or negative values? Probably not
positive_fc_markers <- positive_fc_markers[positive_fc_markers$p_val_adj < 0.05,]
negative_fc_markers <- negative_fc_markers[negative_fc_markers$p_val_adj < 0.05,]
write.table(positive_fc_markers, paste0(output_dir, "POS_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(negative_fc_markers, paste0(output_dir, "NEG_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
# 0.1, 0.585, 1, 2
positive_fc_markers_0.1 <- positive_fc_markers[positive_fc_markers$avg_log2FC > 0.1,]
positive_fc_markers_0.585 <- positive_fc_markers[positive_fc_markers$avg_log2FC > 0.585,]
positive_fc_markers_1 <- positive_fc_markers[positive_fc_markers$avg_log2FC > 1,]
positive_fc_markers_2 <- positive_fc_markers[positive_fc_markers$avg_log2FC > 2,]
negative_fc_markers_0.1 <- negative_fc_markers[negative_fc_markers$avg_log2FC < -0.1,]
negative_fc_markers_0.585 <- negative_fc_markers[negative_fc_markers$avg_log2FC < -0.585,]
negative_fc_markers_1 <- negative_fc_markers[negative_fc_markers$avg_log2FC < -1,]
negative_fc_markers_2 <- negative_fc_markers[negative_fc_markers$avg_log2FC < -2,]
write.table(positive_fc_markers_0.1, paste0(output_dir, "0.1_POS_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(positive_fc_markers_0.585, paste0(output_dir, "0.585_POS_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(positive_fc_markers_1, paste0(output_dir, "1_POS_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(positive_fc_markers_2, paste0(output_dir, "2_POS_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(negative_fc_markers_0.1, paste0(output_dir, "0.1_NEG_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(negative_fc_markers_0.585, paste0(output_dir, "0.585_NEG_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(negative_fc_markers_1, paste0(output_dir, "1_NEG_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(negative_fc_markers_2, paste0(output_dir, "2_NEG_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
}
marker_dir <- "C:/Users/wat2/Desktop/02-28/DEGs/Unfiltered"
output_dir <- "C:/Users/wat2/Desktop/02-28/DEGs/Unfiltered/UPDATED/"
marker_files <- list.files(marker_dir, pattern = "*.csv$", full.names = TRUE)
for(marker_file in marker_files) {
marker_file_content <- read.table(marker_file, sep = ",", header = TRUE)
marker_file_content$p_val_adj <- p.adjust(marker_file_content$p_val, method='fdr')
positive_fc_markers <- marker_file_content[marker_file_content$avg_log2FC > 0,]
negative_fc_markers <- marker_file_content[marker_file_content$avg_log2FC < 0,]
write.table(positive_fc_markers, paste0(output_dir, "UNFILTERED_POS_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(negative_fc_markers, paste0(output_dir, "UNFILTERED_NEG_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
# Should I adjust p value based on only positive or negative values? Probably not
positive_fc_markers <- positive_fc_markers[positive_fc_markers$p_val_adj < 0.05,]
negative_fc_markers <- negative_fc_markers[negative_fc_markers$p_val_adj < 0.05,]
write.table(positive_fc_markers, paste0(output_dir, "POS_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(positive_fc_markers$X, paste0(output_dir, "POS_GENES_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(negative_fc_markers, paste0(output_dir, "NEG_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
# 0.1, 0.585, 1, 2
positive_fc_markers_0.1 <- positive_fc_markers[positive_fc_markers$avg_log2FC > 0.1,]
positive_fc_markers_0.585 <- positive_fc_markers[positive_fc_markers$avg_log2FC > 0.585,]
positive_fc_markers_1 <- positive_fc_markers[positive_fc_markers$avg_log2FC > 1,]
positive_fc_markers_2 <- positive_fc_markers[positive_fc_markers$avg_log2FC > 2,]
negative_fc_markers_0.1 <- negative_fc_markers[negative_fc_markers$avg_log2FC < -0.1,]
negative_fc_markers_0.585 <- negative_fc_markers[negative_fc_markers$avg_log2FC < -0.585,]
negative_fc_markers_1 <- negative_fc_markers[negative_fc_markers$avg_log2FC < -1,]
negative_fc_markers_2 <- negative_fc_markers[negative_fc_markers$avg_log2FC < -2,]
write.table(positive_fc_markers_0.1, paste0(output_dir, "0.1_POS_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(positive_fc_markers_0.585, paste0(output_dir, "0.585_POS_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(positive_fc_markers_1, paste0(output_dir, "1_POS_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(positive_fc_markers_2, paste0(output_dir, "2_POS_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(negative_fc_markers_0.1, paste0(output_dir, "0.1_NEG_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(negative_fc_markers_0.585, paste0(output_dir, "0.585_NEG_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(negative_fc_markers_1, paste0(output_dir, "1_NEG_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(negative_fc_markers_2, paste0(output_dir, "2_NEG_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
}
marker_dir <- "C:/Users/wat2/Desktop/02-28/DEGs/Unfiltered"
output_dir <- "C:/Users/wat2/Desktop/02-28/DEGs/Unfiltered/UPDATED/"
marker_files <- list.files(marker_dir, pattern = "*.csv$", full.names = TRUE)
for(marker_file in marker_files) {
marker_file_content <- read.table(marker_file, sep = ",", header = TRUE)
marker_file_content$p_val_adj <- p.adjust(marker_file_content$p_val, method='fdr')
positive_fc_markers <- marker_file_content[marker_file_content$avg_log2FC > 0,]
negative_fc_markers <- marker_file_content[marker_file_content$avg_log2FC < 0,]
write.table(positive_fc_markers, paste0(output_dir, "UNFILTERED_POS_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(negative_fc_markers, paste0(output_dir, "UNFILTERED_NEG_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
# Should I adjust p value based on only positive or negative values? Probably not
positive_fc_markers <- positive_fc_markers[positive_fc_markers$p_val_adj < 0.05,]
negative_fc_markers <- negative_fc_markers[negative_fc_markers$p_val_adj < 0.05,]
write.table(positive_fc_markers, paste0(output_dir, "POS_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(positive_fc_markers$X, paste0(output_dir, "POS_GENES_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE, col.names = FALSE)
write.table(negative_fc_markers, paste0(output_dir, "NEG_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
# 0.1, 0.585, 1, 2
positive_fc_markers_0.1 <- positive_fc_markers[positive_fc_markers$avg_log2FC > 0.1,]
positive_fc_markers_0.585 <- positive_fc_markers[positive_fc_markers$avg_log2FC > 0.585,]
positive_fc_markers_1 <- positive_fc_markers[positive_fc_markers$avg_log2FC > 1,]
positive_fc_markers_2 <- positive_fc_markers[positive_fc_markers$avg_log2FC > 2,]
negative_fc_markers_0.1 <- negative_fc_markers[negative_fc_markers$avg_log2FC < -0.1,]
negative_fc_markers_0.585 <- negative_fc_markers[negative_fc_markers$avg_log2FC < -0.585,]
negative_fc_markers_1 <- negative_fc_markers[negative_fc_markers$avg_log2FC < -1,]
negative_fc_markers_2 <- negative_fc_markers[negative_fc_markers$avg_log2FC < -2,]
write.table(positive_fc_markers_0.1, paste0(output_dir, "0.1_POS_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(positive_fc_markers_0.585, paste0(output_dir, "0.585_POS_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(positive_fc_markers_1, paste0(output_dir, "1_POS_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(positive_fc_markers_2, paste0(output_dir, "2_POS_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(negative_fc_markers_0.1, paste0(output_dir, "0.1_NEG_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(negative_fc_markers_0.585, paste0(output_dir, "0.585_NEG_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(negative_fc_markers_1, paste0(output_dir, "1_NEG_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(negative_fc_markers_2, paste0(output_dir, "2_NEG_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
}
# Code to parse DEG markers into positive and negative fold change and change Bonferroni to FDR
marker_dir <- "C:/Users/wat2/Desktop/02-28/DEGs/Unfiltered"
output_dir <- "C:/Users/wat2/Desktop/02-28/DEGs/Unfiltered/UPDATED/"
marker_files <- list.files(marker_dir, pattern = "*.csv$", full.names = TRUE)
for(marker_file in marker_files) {
marker_file_content <- read.table(marker_file, sep = ",", header = TRUE)
marker_file_content$p_val_adj <- p.adjust(marker_file_content$p_val, method='fdr')
positive_fc_markers <- marker_file_content[marker_file_content$avg_log2FC > 0,]
negative_fc_markers <- marker_file_content[marker_file_content$avg_log2FC < 0,]
write.table(positive_fc_markers, paste0(output_dir, "UNFILTERED_POS_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(negative_fc_markers, paste0(output_dir, "UNFILTERED_NEG_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
# Should I adjust p value based on only positive or negative values? Probably not
positive_fc_markers <- positive_fc_markers[positive_fc_markers$p_val_adj < 0.05,]
negative_fc_markers <- negative_fc_markers[negative_fc_markers$p_val_adj < 0.05,]
write.table(positive_fc_markers, paste0(output_dir, "POS_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(positive_fc_markers$X, paste0(output_dir, "GENES_POS_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE, col.names = FALSE)
write.table(negative_fc_markers, paste0(output_dir, "NEG_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(negative_fc_markers$X, paste0(output_dir, "GENES_NEG_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE, col.names = FALSE)
# 0.1, 0.585, 1, 2
positive_fc_markers_0.1 <- positive_fc_markers[positive_fc_markers$avg_log2FC > 0.1,]
positive_fc_markers_0.585 <- positive_fc_markers[positive_fc_markers$avg_log2FC > 0.585,]
positive_fc_markers_1 <- positive_fc_markers[positive_fc_markers$avg_log2FC > 1,]
positive_fc_markers_2 <- positive_fc_markers[positive_fc_markers$avg_log2FC > 2,]
negative_fc_markers_0.1 <- negative_fc_markers[negative_fc_markers$avg_log2FC < -0.1,]
negative_fc_markers_0.585 <- negative_fc_markers[negative_fc_markers$avg_log2FC < -0.585,]
negative_fc_markers_1 <- negative_fc_markers[negative_fc_markers$avg_log2FC < -1,]
negative_fc_markers_2 <- negative_fc_markers[negative_fc_markers$avg_log2FC < -2,]
write.table(positive_fc_markers_0.1, paste0(output_dir, "0.1_POS_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(positive_fc_markers_0.1$X, paste0(output_dir, "GENES_0.1_POS_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE, col.names = FALSE)
write.table(positive_fc_markers_0.585, paste0(output_dir, "0.585_POS_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(positive_fc_markers_0.585$X, paste0(output_dir, "GENES_0.585_POS_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE, col.names = FALSE)
write.table(positive_fc_markers_1, paste0(output_dir, "1_POS_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(positive_fc_markers_1$X, paste0(output_dir, "GENES_1_POS_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE, col.names = FALSE)
write.table(positive_fc_markers_2, paste0(output_dir, "2_POS_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(positive_fc_markers_2$X, paste0(output_dir, "GENES_2_POS_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE, col.names = FALSE)
write.table(negative_fc_markers_0.1, paste0(output_dir, "0.1_NEG_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(negative_fc_markers_0.1$X, paste0(output_dir, "GENES_0.1_NEG_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE, col.names = FALSE)
write.table(negative_fc_markers_0.585, paste0(output_dir, "0.585_NEG_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(negative_fc_markers_0.585$X, paste0(output_dir, "GENES_0.585_NEG_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE, col.names = FALSE)
write.table(negative_fc_markers_1, paste0(output_dir, "1_NEG_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(negative_fc_markers_1$X, paste0(output_dir, "GENES_1_NEG_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE, col.names = FALSE)
write.table(negative_fc_markers_2, paste0(output_dir, "2_NEG_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE)
write.table(negative_fc_markers_2$X, paste0(output_dir, "GENES_2_NEG_", basename(marker_file)), quote = FALSE, sep = ",", row.names = FALSE, col.names = FALSE)
}
