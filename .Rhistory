install.packages(c("DT", "evaluate", "xfun"))
base_scRNA_dir = "C:/Users/williamthistle/Desktop/snRNA_seq_data"
sample_metadata = read.csv("C:/Users/williamthistle/Documents/GitHub/Influenza/current_sample_metadata_minus_8d5be1a4937a7ad3.csv")
sample_list = list.dirs(base_scRNA_dir, recursive = FALSE)
sample_metadata
sample_list
strsplit(sample_list, "/")
sample_list_2 <- lapply(sample_list, tail, n = 1L)
sample_list_2
sample_list
sample_list <- strsplit(sample_list, "/")
sample_list_2 <- lapply(sample_list, tail, n = 1L)
sample_list_2
?tail
sample_list
sample_list <-lapply(sample_list, tail, n = 1L)
sample_list
unlist(sample_list)
base_scRNA_dir <- "C:/Users/williamthistle/Desktop/snRNA_seq_data"
sample_metadata <- read.csv("C:/Users/williamthistle/Documents/GitHub/Influenza/current_sample_metadata_minus_8d5be1a4937a7ad3.csv")
sample_list <- list.dirs(base_scRNA_dir, recursive = FALSE)
sample_list <- strsplit(sample_list, "/")
sample_list <- unlist(lapply(sample_list, tail, n = 1L))
sample_list
sample_metadata
sample_metadata[sample_metadata$X_aliquot_id == "2deb7ca69a194aa9",]
length(sample_metadata[sample_metadata$X_aliquot_id == "2deb7ca69a194aa9",])
nrow(sample_metadata[sample_metadata$X_aliquot_id == "2deb7ca69a194aa9",])
aliquot = "2deb7ca69a194aa9"
current_sample = sample_metadata[sample_metadata$X_aliquot_id == aliquot,]
current_sample$SUBJECT_ID
current_subject = current_sample$SUBJECT_ID
sample_metadata[sample_metadata$SUBJECT_ID == current_subject ,]
nrow(sample_metadata[sample_metadata$SUBJECT_ID == current_subject ,])
test = c()
"blah" in test
"blah" %in% test
test = c("blah")
"blah" %in% test
all_samples_associated_with_current_subject
all_samples_associated_with_current_subject = sample_metadata[sample_metadata$SUBJECT_ID == current_subject ,]
all_samples_associated_with_current_subject
all_samples_associated_with_current_subject[all_samples_associated_with_current_subject$Time_Point == "D-1"]
all_samples_associated_with_current_subject[all_samples_associated_with_current_subject$Time_Point == "D-1",]
test - c()
test = c()
test = append(test, 5)
test
base_scRNA_dir <- "C:/Users/williamthistle/Desktop/snRNA_seq_data"
sample_metadata <- read.csv("C:/Users/williamthistle/Documents/GitHub/Influenza/current_sample_metadata_minus_8d5be1a4937a7ad3.csv")
aliquot_list <- list.dirs(base_scRNA_dir, recursive = FALSE)
aliquot_list <- strsplit(sample_list, "/")
aliquot_list <- unlist(lapply(sample_list, tail, n = 1L))
# D1.id stores sample IDs for day -1 samples
# D28.id stores sample IDs for day 28 samples
D1.id <- c()
D28.id <- c()
for (aliquot in aliquot_list) {
# Grab current sample metadata, subject associated with sample, and then check to see whether subject has two samples
# (D-1 and D28)
current_sample = sample_metadata[sample_metadata$X_aliquot_id == aliquot,]
current_subject = current_sample$SUBJECT_ID
all_samples_associated_with_current_subject = sample_metadata[sample_metadata$SUBJECT_ID == current_subject ,]
if (nrow(all_samples_associated_with_current_subject) == 2) {
# Now, we grab our D-1 and D28 aliquot names.
# If D-1 is not in D1.id, then add D-1 to D1.id and D28 to D28.id
d_negative_1_aliquot <- all_samples_associated_with_current_subject[all_samples_associated_with_current_subject$Time_Point == "D-1",]$X_aliquot_id
d_28_aliquot <- all_samples_associated_with_current_subject[all_samples_associated_with_current_subject$Time_Point == "D28",]$X_aliquot_id
if (d_negative_1_aliquot %in% D1.id == FALSE) {
D1.id <- append(D1.id, d_negative_1_aliquot)
D28.id <- append(D28.id, d_28_aliquot)
}
}
}
D1.id
D8.id
D28.id
flu.list <- list()
# Traverse all day 1 samples
for (idx in 1:length(D1.id)) {
# Grab current sample name
i <- D1.id[idx]
# Read in h5 matrix associated with current sample
flu.list[[i]] <- Read10X_h5(paste0(i, "/outs/filtered_feature_bc_matrix.h5"))
prefix <- paste0("Sample_", idx, "_D1#")
print(prefix)
colnames(flu.list[[i]]) <- paste0(prefix, colnames(flu.list[[i]]))
zxz
zx
z
}
library(Seurat)
library(ggplot2)
flu.list <- list()
# Traverse all day 1 samples
for (idx in 1:length(D1.id)) {
# Grab current sample name
i <- D1.id[idx]
# Read in h5 matrix associated with current sample
flu.list[[i]] <- Read10X_h5(paste0(base_scRNA_dir, i, "/outs/filtered_feature_bc_matrix.h5"))
prefix <- paste0("Sample_", idx, "_D1#")
print(prefix)
colnames(flu.list[[i]]) <- paste0(prefix, colnames(flu.list[[i]]))
}
install.packages("hdf5r")
flu.list <- list()
# Traverse all day 1 samples
for (idx in 1:length(D1.id)) {
# Grab current sample name
i <- D1.id[idx]
# Read in h5 matrix associated with current sample
flu.list[[i]] <- Read10X_h5(paste0(base_scRNA_dir, i, "/outs/filtered_feature_bc_matrix.h5"))
prefix <- paste0("Sample_", idx, "_D1#")
print(prefix)
colnames(flu.list[[i]]) <- paste0(prefix, colnames(flu.list[[i]]))
}
i <- D1.id[1]
id
i
paste0(base_scRNA_dir, i, "/outs/filtered_feature_bc_matrix.h5"
)
base_scRNA_dir <- "C:/Users/williamthistle/Desktop/snRNA_seq_data/"
flu.list <- list()
# Traverse all day 1 samples
for (idx in 1:length(D1.id)) {
# Grab current sample name
i <- D1.id[idx]
# Read in h5 matrix associated with current sample
flu.list[[i]] <- Read10X_h5(paste0(base_scRNA_dir, i, "/outs/filtered_feature_bc_matrix.h5"))
prefix <- paste0("Sample_", idx, "_D1#")
print(prefix)
colnames(flu.list[[i]]) <- paste0(prefix, colnames(flu.list[[i]]))
}
idx
D1.id[idx]
# Location of scRNA data - data are organized by aliquot ID
base_scRNA_dir <- "C:/Users/williamthistle/Desktop/snRNA_seq_data/"
sample_metadata <- read.csv("C:/Users/williamthistle/Documents/GitHub/Influenza/current_sample_metadata_minus_8d5be1a4937a7ad3.csv")
aliquot_list <- list.dirs(base_scRNA_dir, recursive = FALSE)
aliquot_list <- strsplit(sample_list, "/")
aliquot_list <- unlist(lapply(sample_list, tail, n = 1L))
# D1.id stores sample IDs for day -1 samples
# D28.id stores sample IDs for day 28 samples
D1.id <- c()
D28.id <- c()
for (aliquot in aliquot_list) {
# Grab current sample metadata, subject associated with sample, and then check to see whether subject has two samples
# (D-1 and D28)
current_sample = sample_metadata[sample_metadata$X_aliquot_id == aliquot,]
current_subject = current_sample$SUBJECT_ID
all_samples_associated_with_current_subject = sample_metadata[sample_metadata$SUBJECT_ID == current_subject ,]
if (nrow(all_samples_associated_with_current_subject) == 2) {
# Now, we grab our D-1 and D28 aliquot names.
# If D-1 is not in D1.id, then add D-1 to D1.id and D28 to D28.id
d_negative_1_aliquot <- all_samples_associated_with_current_subject[all_samples_associated_with_current_subject$Time_Point == "D-1",]$X_aliquot_id
d_28_aliquot <- all_samples_associated_with_current_subject[all_samples_associated_with_current_subject$Time_Point == "D28",]$X_aliquot_id
if (d_negative_1_aliquot %in% D1.id == FALSE & d_negative_1_aliquot %in% aliquot_list & d_28_aliquot %in% aliquot_list) {
D1.id <- append(D1.id, d_negative_1_aliquot)
D28.id <- append(D28.id, d_28_aliquot)
}
}
}
D1.id
D8.id
D28.id
flu.list <- list()
# Traverse all day 1 samples
for (idx in 1:length(D1.id)) {
# Grab current sample name
i <- D1.id[idx]
# Read in h5 matrix associated with current sample
flu.list[[i]] <- Read10X_h5(paste0(base_scRNA_dir, i, "/outs/filtered_feature_bc_matrix.h5"))
prefix <- paste0("Sample_", idx, "_D1#")
print(prefix)
colnames(flu.list[[i]]) <- paste0(prefix, colnames(flu.list[[i]]))
}
for (idx in 1:length(D28.id)) {
i <- D28.id[idx]
flu.list[[i]] <- Read10X_h5(paste0(base_scRNA_dir, i, "/outs/filtered_feature_bc_matrix.h5"))
prefix <- paste0("Sample_", idx, "_D28#")
print(prefix)
colnames(flu.list[[i]]) <- paste0(prefix, colnames(flu.list[[i]]))
}
